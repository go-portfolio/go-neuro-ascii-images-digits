## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ—Å—Ç—É—é **—Å–≤—ë—Ä—Ç–æ—á–Ω—É—é –Ω–µ–π—Ä–æ—Å–µ—Ç—å (CNN)** –Ω–∞ Go, –∫–æ—Ç–æ—Ä–∞—è –æ–±—É—á–∞–µ—Ç—Å—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å **—Ä—É–∫–æ–ø–∏—Å–Ω—ã–µ —Ü–∏—Ñ—Ä—ã**.

## –ó–∞–ø—É—Å–∫
–û–±—É—á–µ–Ω–∏–µ
```
# –ó–∞–ø—É—Å—Ç–∏—Ç—å training –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ go run
go run ./cmd/train/main.go
```
–ü—Ä–æ–≤–µ—Ä–∫–∞
```
go run ./cmd/train/test.go
```

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–µ—Ç—å

1. **–°–≤—ë—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π (Conv2D)**

   * –ü—Ä–∏–º–µ–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é, —á—Ç–æ–±—ã –≤—ã—è–≤–∏—Ç—å **–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏** (–≥—Ä–∞–Ω–∏—Ü—ã, –ª–∏–Ω–∏–∏, —à—Ç—Ä–∏—Ö–∏).
   * –ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞—é—Ç—Å—è **–∫–∞—Ä—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –≥–¥–µ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —ç—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç—ã.

2. **–ê–∫—Ç–∏–≤–∞—Ü–∏—è (ReLU)**

   * –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –æ–±–Ω—É–ª—è–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ.
   * –ü–æ–º–æ–≥–∞–µ—Ç —Å–µ—Ç–∏ —É—á–∏—Ç—å—Å—è —Å–ª–æ–∂–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º.

3. **–ü—É–ª–∏–Ω–≥ (MaxPool2x2)**

   * –£–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∫–∞—Ä—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤–¥–≤–æ–µ.
   * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç **—Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏** (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–∞–∂–¥–æ–º –±–ª–æ–∫–µ).
   * –£–±–∏—Ä–∞–µ—Ç –ª–∏—à–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ –∏ –¥–µ–ª–∞–µ—Ç —Å–µ—Ç—å **—É—Å—Ç–æ–π—á–∏–≤–æ–π –∫ —Å–º–µ—â–µ–Ω–∏—é –∏–ª–∏ —à—É–º—É**.

4. **Flatten**

   * –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –∫–∞—Ä—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –æ–¥–∏–Ω –¥–ª–∏–Ω–Ω—ã–π –≤–µ–∫—Ç–æ—Ä, —á—Ç–æ–±—ã –ø–æ–¥–∞—Ç—å –Ω–∞ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π.

5. **–ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π (Dense)**

   * –°—É–º–º–∏—Ä—É–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –≤–µ—Å–∞–º–∏ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–º–µ—â–µ–Ω–∏–µ (bias).
   * –ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º **–ª–æ–≥–∏—Ç—ã** ‚Äî ¬´—Å—ã—Ä—ã–µ –æ—Ü–µ–Ω–∫–∏¬ª –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É.

6. **Softmax**

   * –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –ª–æ–≥–∏—Ç—ã –≤ **–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ (—Å—É–º–º–∞ = 1).
   * –°–µ—Ç—å ¬´–≥–æ–≤–æ—Ä–∏—Ç¬ª, –Ω–∞—Å–∫–æ–ª—å–∫–æ —É–≤–µ—Ä–µ–Ω–∞, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ü–∏—Ñ—Ä–µ.

7. **Cross-Entropy Loss**

   * –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–µ—Ç–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –º–µ—Ç–∫–æ–π –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç **–æ—à–∏–±–∫—É**, —á—Ç–æ–±—ã —Å–µ—Ç—å –º–æ–≥–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å–∞.

### –ß—Ç–æ —Å–µ—Ç—å –∏—â–µ—Ç

* –û–Ω–∞ **–∏—â–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ —Ü–∏—Ñ—Ä** –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏:

  * –ª–∏–Ω–∏–∏, —à—Ç—Ä–∏—Ö–∏, –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è
  * –∏—Ö —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
* –ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å–µ—Ç—å –¥–µ–ª–∞–µ—Ç **–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞** (0‚Äì9).
* –ö–∞–∂–¥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–∏–ª—å—Ç—Ä—ã, –ø—É–ª–∏–Ω–≥ –∏ Dense —Å–ª–æ–π, —á—Ç–æ–±—ã —Å–µ—Ç—å –º–æ–≥–ª–∞ –ø–æ–Ω—è—Ç—å, **–∫–∞–∫–∞—è —Ü–∏—Ñ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∞**.

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

* –°–µ—Ç—å –≤—ã–≤–æ–¥–∏—Ç:

  * **–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å**
  * **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è**
  * **–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å –º–µ—Ç–∫–æ–π** (–¥–ª—è —Ç–µ—Å—Ç–∞)
  * **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º** ‚Äî –º–æ–∂–Ω–æ –≤–∏–¥–µ—Ç—å, –Ω–∞ —á—Ç–æ —Å–µ—Ç—å ¬´—Å–º–æ—Ç—Ä–∏—Ç¬ª –∏ –∫–∞–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å.

---

          –í—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 28x28
                   ‚îÇ
                   ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ  Conv2D     ‚îÇ  <- 8 —Ñ–∏–ª—å—Ç—Ä–æ–≤ 3x3, –∏—â–µ—Ç –ª–∏–Ω–∏–∏ –∏ —à—Ç—Ä–∏—Ö–∏
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ   ReLU      ‚îÇ  <- –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ MaxPool2x2  ‚îÇ  <- —É–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ  Flatten    ‚îÇ  <- –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –∫–∞—Ä—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –æ–¥–∏–Ω –≤–µ–∫—Ç–æ—Ä
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ   Dense     ‚îÇ  <- —Å—É–º–º–∏—Ä—É–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ª–æ–≥–∏—Ç—ã
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ  Softmax    ‚îÇ  <- –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –ª–æ–≥–∏—Ç—ã –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–æ–≤
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚ñº
          –í—ã—Ö–æ–¥: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–æ–≤ 0..9
–ê–≥–∞, —Ç–µ–ø–µ—Ä—å –ø–æ–Ω—è—Ç–Ω–æ, –ø–æ—á–µ–º—É –ø—É—Ç–∞–µ—à—å—Å—è üòä

–¢–æ, —á—Ç–æ —Ç—ã –≤–∏–¥–∏—à—å –≤ –∫–æ–Ω—Å–æ–ª–∏ ‚Äî —ç—Ç–æ **ASCII-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Å–µ–≤–¥–æ-MNIST –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–µ–π `RandomImage28x28()`. –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º, —á—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

---

### 1Ô∏è‚É£ –ö–∞–∫ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

–§—É–Ω–∫—Ü–∏—è `RandomImage28x28()` –¥–µ–ª–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—â–µ–π:

1. **–§–æ–Ω–æ–≤—ã–π —à—É–º** ‚Äì –ø–æ—á—Ç–∏ –ø—É—Å—Ç–∞—è —Å–µ—Ç–∫–∞ 28√ó28 (`.`).

2. **–°–ª—É—á–∞–π–Ω—ã–µ —à—Ç—Ä–∏—Ö–∏/–ª–∏–Ω–∏–∏** ‚Äì –∏–º–∏—Ç–∞—Ü–∏—è —Ä—É–∫–æ–ø–∏—Å–Ω–æ–π —Ü–∏—Ñ—Ä—ã. –≠—Ç–∏ –ø–∏–∫—Å–µ–ª–∏ —è—Ä—á–µ, –ø–æ—ç—Ç–æ–º—É –º—ã –∏—Ö –æ–±–æ–∑–Ω–∞—á–∞–µ–º `+`, `*`, `#` –≤ ASCII:

   * `.` ‚Äî –ø–æ—á—Ç–∏ –ø—É—Å—Ç–æ (—Ñ–æ–Ω)
   * `+` ‚Äî —Å–ª–∞–±—ã–π —à—Ç—Ä–∏—Ö
   * `*` ‚Äî —Å—Ä–µ–¥–Ω–∏–π —à—Ç—Ä–∏—Ö
   * `#` ‚Äî —Å–∏–ª—å–Ω—ã–π –ø–∏–∫—Å–µ–ª—å, –≥–¥–µ –ª–∏–Ω–∏—è —è—Ä–∫–∞—è

3. **–†–∞–∑–º—ã—Ç–∏–µ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è** ‚Äì —á—Ç–æ–±—ã —à—Ç—Ä–∏—Ö–∏ –≤—ã–≥–ª—è–¥–µ–ª–∏ –±–æ–ª–µ–µ ¬´–ø–ª–∞–≤–Ω–æ¬ª –∏ –∑–Ω–∞—á–µ–Ω–∏—è –±—ã–ª–∏ –º–µ–∂–¥—É 0 –∏ 1.

---

### 2Ô∏è‚É£ –ü–æ—á–µ–º—É —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Å—Ç—Ä–∞–Ω–Ω–æ

* –≠—Ç–æ **–Ω–µ –Ω–∞—Å—Ç–æ—è—â–∏–µ —Ü–∏—Ñ—Ä—ã**, –∞ —Å–ª—É—á–∞–π–Ω—ã–µ –ª–∏–Ω–∏–∏ –∏ —à—Ç—Ä–∏—Ö–∏, —á—Ç–æ–±—ã —Å–µ—Ç—å –º–æ–≥–ª–∞ —É—á–∏—Ç—å—Å—è –Ω–∞ ¬´–ø–æ—Ö–æ–∂–∏—Ö –Ω–∞ —Ü–∏—Ñ—Ä—ã¬ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö.
* ASCII-–≤—ã–≤–æ–¥ —Å–∏–ª—å–Ω–æ —É–ø—Ä–æ—â—ë–Ω ‚Äî –º—ã –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤–æ–¥–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å–∏–º–≤–æ–ª—ã.
* –ü–æ—ç—Ç–æ–º—É –∏–Ω–æ–≥–¥–∞ –ª–∏–Ω–∏–∏ –Ω–µ –ø–æ—Ö–æ–∂–∏ –Ω–∞ —Ü–∏—Ñ—Ä—ã. –ù–∞–ø—Ä–∏–º–µ—Ä:

```
.+*####*+...................
```

‚Äî —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ —Å–ª—É—á–∞–π–Ω—ã—Ö —à—Ç—Ä–∏—Ö–æ–≤, –≥–¥–µ `#` ‚Äî —è—Ä–∫–∏–π –ø–∏–∫—Å–µ–ª—å, `*` ‚Äî —Å—Ä–µ–¥–Ω–∏–π, `+` ‚Äî —Å–ª–∞–±—ã–π.

---

–ü—Ä–∏–º–µ—Ä –≤ ASCII:
```
++..+++++++++.....+.++++++++
++++++++++++++++++++++++++++
++++++++++++++++++++++++++++
+++++++++++++++++++++++++++.
+++++++++++++++++++++++++.++
++++++++++..++++++++++++++++
+++++++.++++++++++++++++++++
++++++++++.+++++++++++++++++
+++++++##############*++++++
+++++++##*++++++++##*+++++++
++++..+*#+++++++++##*++++++.
+++++++##*++++++++*#+++++++.
+++++++*#+++++++++##*+++++++
.++++++##############*++++++
+++++++++++++..+++##*++++++.
++++++++++++++++++##*+++++++
.+++++++++++++++++##*+++++++
+..+++++++++++++++##*+++++++
.++++++++++.++++++##*+++++++
+++++++##############*++++++
.++.++++++.++++++++++++++++.
+++++++++++++++++++++.++++++
+++++++++++++++++++++++++++.
++++++++++.+++++++++++++++++
.+++++++++++++++++++++++++++
++++++++++++++++++++++++++++
+++++++++++++++++++++++++++.
++++++.++.+++++++.++.+++++++
```

