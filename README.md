# CNN –ø—Ä–∏–º–µ—Ä –≤ Go

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –ø—Ä—è–º–æ–≥–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è (forward pass) –∏ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è (backprop) –≤ —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏, –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–π –Ω–∞ Go.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∞–º–æ–ø–∏—Å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ **go-cnn**, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–≤—ë—Ä—Ç–∫–∏, –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –ø—É–ª–∏–Ω–≥–∞, flatten –∏ dense —Å–ª–æ—è.

## üìå –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–≥–æ —Å–ª–æ—è —Å 8 —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ 3√ó3
* –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:

  * Conv2D
  * ReLU
  * MaxPool2√ó2
  * Flatten
  * Dense
  * Softmax
* –†–∞—Å—á—ë—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å CrossEntropy
* –û–±—É—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ dense-—Å–ª–æ—è (–≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è Conv2D –∑–¥–µ—Å—å –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)
* –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π "–∫–∞—Ä—Ç–∏–Ω–∫–∏" 28√ó28 –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å–µ—Ç–∏

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
go get github.com/go-portfolio/go-cnn/cnn
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É

```bash
go run main.go
```

### –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥

–ù–∞ —ç–∫—Ä–∞–Ω –≤—ã–≤–æ–¥–∏—Ç—Å—è loss –¥–ª—è –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–∏ –æ–±—É—á–µ–Ω–∏—è:

```
Epoch 0  Loss=2.302189
Epoch 1  Loss=2.297514
Epoch 2  Loss=2.310011
...
```

## üß† –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

–ú–æ–¥–µ–ª—å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª–æ—ë–≤:

1. **Conv2D (8 —Ñ–∏–ª—å—Ç—Ä–æ–≤ 3√ó3)**
   –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é 28√ó28.

2. **ReLU**
   –ù–µ–ª–∏–Ω–µ–π–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è.

3. **MaxPool 2√ó2**
   –£–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∫–∞—Ä—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ 4 —Ä–∞–∑–∞.

4. **Flatten**
   –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –≤—ã—Ö–æ–¥ Conv+Pool –≤ –≤–µ–∫—Ç–æ—Ä –¥–ª–∏–Ω–æ–π 1352.

5. **Dense (1352 ‚Üí 10)**
   –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π, –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â–∏–π 10 –∫–ª–∞—Å—Å–æ–≤.

6. **Softmax**
   –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—ã—Ö–æ–¥—ã dense-—Å–ª–æ—è –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏.

7. **CrossEntropy Loss**
   –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –º–µ—Ç–∫–æ–π (label).

## üîÑ –û–±—É—á–µ–Ω–∏–µ

–¶–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 10 —ç–ø–æ—Ö.
–ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏:

* –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–∞—è "–∫–∞—Ä—Ç–∏–Ω–∫–∞" 28√ó28
* –í—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–π —Ü–µ–ª–µ–≤–æ–π –∫–ª–∞—Å—Å
* –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è forward pass
* –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≥—Ä–∞–¥–∏–µ–Ω—Ç —Ç–æ–ª—å–∫–æ –ø–æ dense-—Å–ª–æ—é
* –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤–µ—Å–∞ `W` –∏ —Å–º–µ—â–µ–Ω–∏—è `b`

> –°–≤—ë—Ä—Ç–æ—á–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –Ω–µ –æ–±—É—á–∞—é—Ç—Å—è ‚Äî –µ—Å–ª–∏ –Ω—É–∂–Ω–æ, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é backprop –¥–ª—è Conv2D –∏ MaxPool.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ main.go
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ go.mod
```

## üß© randomImage28x28()

–ü—Ä–æ—Å—Ç–∞—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, —Å–æ–∑–¥–∞—é—â–∞—è –º–∞—Ç—Ä–∏—Ü—É 28√ó28 —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–∏–∫—Å–µ–ª–µ–π (0..1).

## üìå –ü–ª–∞–Ω—ã –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é

–ú–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –ø—Ä–æ–µ–∫—Ç, –¥–æ–±–∞–≤–∏–≤:

* Backprop –¥–ª—è Conv2D
* –†–µ–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ MNIST
* –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫—É –≤–µ—Å–æ–≤
* –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
* –£–ª—É—á—à–µ–Ω–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (LeNet, –Ω–µ–±–æ–ª—å—à–∏–µ CNN)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ ‚Äî –º–æ–≥—É –ø–æ–º–æ—á—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª—é–±–æ–π –∏–∑ –ø—É–Ω–∫—Ç–æ–≤.
